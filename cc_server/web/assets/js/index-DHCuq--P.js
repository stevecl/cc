import{R as ut,r as $,S as X,o as Q,e as p,f as b,F as x,g as F,l as T,k as o,t as V,T as U,z as q,U as dt,d as C,h as c,w as E,y as K,A as J,s as H,v as z,q as L,i as B,j as Y,E as A,V as rt,H as ct,W as pt,u as ft,b as vt,B as bt,X as ht,n as Et}from"./index-0bWp895S.js";import{a as _,_ as j,b as Z,f as ee,h as te,i as ae,j as se,k as oe,l as ne,m as ie,n as le,o as ge,p as _e,q as me,r as ue,s as de,t as re,u as ce,v as pe,w as fe,x as ve,y as be,z as he,A as Ee,B as ye,C as ke,D as Ie,E as Ce,F as Te,G as De,H as Oe,I as we,J as Ve,K as Re,L as je,M as $e,N as xe,O as Le,P as Ae,Q as Pe,R as Me,S as Se,T as Ne,U as Be,V as Ge,W as Ue,X as qe,Y as He,Z as ze,$ as Fe,a0 as Ke,a1 as Je,a2 as We,a3 as Xe,a4 as Qe,a5 as Ye,a6 as Ze,a7 as et,a8 as tt,a9 as at,aa as st,ab as ot,ac as nt,ad as it,ae as lt,af as gt,ag as _t,ah as yt,ai as kt,aj as R,ak as It,al as Ct}from"./index-MBh0lVgE.js";const mt=ut("common",()=>{const e=$({}),r=Object.assign({"../material/assistBlank/config.js":()=>_(()=>import("./config-6mH-mRtp.js"),[],import.meta.url),"../material/assistLine/config.js":()=>_(()=>import("./config-DVat-B7F.js"),[],import.meta.url),"../material/buttons/config.js":()=>_(()=>import("./config-64o6n3zH.js"),[],import.meta.url),"../material/coupon/config.js":()=>_(()=>import("./config-B8gpgxka.js"),[],import.meta.url),"../material/floatButtons/config.js":()=>_(()=>import("./config-B3cqXnKf.js"),[],import.meta.url),"../material/goods/config.js":()=>_(()=>import("./config-DNdpgWls.js"),[],import.meta.url),"../material/goodsLikes/config.js":()=>_(()=>import("./config-CxGGstuq.js"),[],import.meta.url),"../material/goodsRanking/config.js":()=>_(()=>import("./config-FkYGNhZh.js"),[],import.meta.url),"../material/goodsScore/config.js":()=>_(()=>import("./config-DBIqUa65.js"),[],import.meta.url),"../material/goodsTabbar/config.js":()=>_(()=>import("./config-CxU5YkRA.js"),[],import.meta.url),"../material/listMenu/config.js":()=>_(()=>import("./config-Dc0rDWKo.js"),[],import.meta.url),"../material/memberCenter/config.js":()=>_(()=>import("./config-DZu-fHQm.js"),[],import.meta.url),"../material/order/config.js":()=>_(()=>import("./config-D-9Dob9R.js"),[],import.meta.url),"../material/pictureShow/config.js":()=>_(()=>import("./config-CLiev0JT.js"),[],import.meta.url),"../material/search/config.js":()=>_(()=>import("./config-X6HfCMdb.js"),[],import.meta.url),"../material/shop/config.js":()=>_(()=>import("./config-Cclmipy3.js"),[],import.meta.url),"../material/singleChart/config.js":()=>_(()=>import("./config-BJnqfvFa.js"),[],import.meta.url),"../material/swiper/config.js":()=>_(()=>import("./config-IMxg-2Lq.js"),[],import.meta.url),"../material/tabbar/config.js":()=>_(()=>import("./config-Cp0HuyK0.js"),[],import.meta.url),"../material/title/config.js":()=>_(()=>import("./config-C44-TJ-5.js"),[],import.meta.url),"../material/video/config.js":()=>_(()=>import("./config-DPJ3dUps.js"),[],import.meta.url)});return Object.keys(r).forEach(async l=>{let n=l.replace(/\/config.js/,"").replace(/.*\//,"");e.value[n]={name:n,componentName:"diy-"+n,configComponent:"conf-"+n,getDefaultConfig:r[l]}}),{materialDatas:e}}),Tt={name:"商品类",data:[{name:"商品组",icon:"goods.png",component:"goods"},{name:"选项卡",icon:"tabbar.png",component:"goodsTabbar"},{name:"猜你喜欢",icon:"guess.png",component:"goodsLikes"},{name:"商品排行",icon:"goodsRanking.png",component:"goodsRanking"},{name:"积分商城",icon:"creditshop.png",component:"goodsScore"}]},Dt={name:"图文类 ",data:[{name:"搜索框",icon:"search.png",component:"search"},{name:"图片轮播",icon:"banner.png",component:"swiper"},{name:"图片(热区)",icon:"picture.png",component:"singleChart"},{name:"图片展播",icon:"pictures.png",component:"pictureShow"},{name:"列表导航",icon:"listmenu.png",component:"listMenu"},{name:"辅助线",icon:"line.png",component:"assistLine"},{name:"标题栏",icon:"title.png",component:"title"},{name:"辅助空白",icon:"blank.png",component:"assistBlank"},{name:"按钮组",icon:"menu.png",component:"buttons"},{name:"视频播放",icon:"video.png",component:"video"},{name:"浮动按钮",icon:"float.png",unique:!0,component:"floatButtons"}]},Ot={name:"会员中心",permission:["MEMBER_CENTER"],data:[{name:"用户信息组",icon:"member.png",unique:!0,component:"memberCenter"},{name:"订单组",icon:"search.png",component:"order"},{name:"店铺组",icon:"search.png",component:"shop"},{name:"优惠券",icon:"coupon.png",component:"coupon"}]},G=[Tt,Dt,Ot],wt={class:"module-select-box"},Vt={key:0,class:"module-list"},Rt={class:"module-list_type"},jt={class:"module-list_data"},$t=["onClick"],xt={class:"title"},Lt={__name:"materialPanel",emits:["add","global"],setup(e,{emit:r}){const{materialDatas:l}=mt();console.log("materialDatas",G);const n=r,a=X("baseInfo"),t=s=>({backgroundImage:`url(${new URL(Object.assign({"../../assets/images/default/audio.png":Z,"../../assets/images/default/banner.png":ee,"../../assets/images/default/bannerGoods.png":te,"../../assets/images/default/bargain.png":ae,"../../assets/images/default/blank.png":se,"../../assets/images/default/car1.png":oe,"../../assets/images/default/car2.png":ne,"../../assets/images/default/car3.png":ie,"../../assets/images/default/car4.png":le,"../../assets/images/default/channelvideo.png":ge,"../../assets/images/default/copyright.png":_e,"../../assets/images/default/countdown.png":me,"../../assets/images/default/coupon.png":ue,"../../assets/images/default/couponbag.png":de,"../../assets/images/default/course.png":re,"../../assets/images/default/creditshop.png":ce,"../../assets/images/default/creditsign.png":pe,"../../assets/images/default/cube.png":fe,"../../assets/images/default/default_banner.png":ve,"../../assets/images/default/default_btn1.png":be,"../../assets/images/default/default_btn2.png":he,"../../assets/images/default/default_btn3.png":Ee,"../../assets/images/default/default_btn4.png":ye,"../../assets/images/default/default_img.jpg":ke,"../../assets/images/default/default_picture.png":Ie,"../../assets/images/default/default_video.png":Ce,"../../assets/images/default/fixedsearch.png":Te,"../../assets/images/default/float.png":De,"../../assets/images/default/form.png":Oe,"../../assets/images/default/giftcard.png":we,"../../assets/images/default/goods,list.png":Ve,"../../assets/images/default/goods,one.png":Re,"../../assets/images/default/goods.png":je,"../../assets/images/default/goodsRanking.png":$e,"../../assets/images/default/groups.png":xe,"../../assets/images/default/groupscashback.png":Le,"../../assets/images/default/guess.png":Ae,"../../assets/images/default/guide.png":Pe,"../../assets/images/default/home-b.png":Me,"../../assets/images/default/hotel.png":Se,"../../assets/images/default/lecturer.png":Ne,"../../assets/images/default/line.png":Be,"../../assets/images/default/listmenu.png":Ge,"../../assets/images/default/live.png":Ue,"../../assets/images/default/member.png":qe,"../../assets/images/default/menu.png":He,"../../assets/images/default/note.png":ze,"../../assets/images/default/notice.png":Fe,"../../assets/images/default/otherGoods,three.png":Ke,"../../assets/images/default/otherGoods,three2.png":Je,"../../assets/images/default/otherGoods,three3.png":We,"../../assets/images/default/picture.png":Xe,"../../assets/images/default/pictures.png":Qe,"../../assets/images/default/presell.png":Ye,"../../assets/images/default/richtext.png":Ze,"../../assets/images/default/room.png":et,"../../assets/images/default/search.png":tt,"../../assets/images/default/seckill.png":at,"../../assets/images/default/tabbar.png":st,"../../assets/images/default/title.png":ot,"../../assets/images/default/title3.png":nt,"../../assets/images/default/twoGoods,list2.png":it,"../../assets/images/default/twoGoods,two.png":lt,"../../assets/images/default/video.png":gt,"../../assets/images/default/wxlive.png":_t})[`../../assets/images/default/${s}`],import.meta.url).href})`});return Q(async()=>{if(Object.keys(l).some(s=>!l[s].title))for(const s in l){let i=(await l[s].getDefaultConfig()).default;l[s].title=i.title,l[s].defConfig=i,delete l[s].getDefaultConfig}}),(s,i)=>(p(),b("div",wt,[(p(!0),b(x,null,F(T(G),(m,d)=>{var y;return p(),b(x,{key:d},[!m.permission||(y=m.permission)!=null&&y.includes(T(a).category)?(p(),b("div",Vt,[o("div",Rt,V(m.name)+"("+V(m.data.length)+")",1),o("div",jt,[(p(!0),b(x,null,F(m.data,(h,k)=>(p(),b("div",{class:"module-list_data_item",style:U(t(h.icon)),key:"c_"+k,onClick:D=>n("add",T(l)[h.component],h.unique)},[o("p",xt,V(h.name),1)],12,$t))),128))])])):q("",!0)],64)}),128))]))}},At=j(Lt,[["__scopeId","data-v-8739772d"]]),Pt={class:"phone-wrapper"},Mt={class:"diy-phone"},St={class:"phone_title"},Nt={__name:"renderEngine",props:{pageConfig:Object},emits:["select"],setup(e,{emit:r}){const l=r;return(n,a)=>(p(),b("div",Pt,[o("div",Mt,[o("div",{class:"text-overflow phone-header",onClick:a[0]||(a[0]=t=>l("select"))},[o("div",St,V(e.pageConfig.templateTitle),1)]),o("div",{class:"custom-scroll-bar phone-body",style:U({"background-color":e.pageConfig.backgroundColor})},[dt(n.$slots,"default",{},void 0,!0)],4)])]))}},Bt=j(Nt,[["__scopeId","data-v-06ef4988"]]),P=e=>(H("data-v-64696a76"),e=e(),z(),e),Gt=P(()=>o("div",{class:"module-edit-title"},"页面设置",-1)),Ut=P(()=>o("p",{class:"tips-info"},"注意：页面名称是便于后台查找。",-1)),qt=P(()=>o("div",{class:"tips-info",style:{margin:"-10px 0 10px 78px"}},"建议尺寸256 * 414 (大小建议不超过800k，以免影响加载速度)",-1)),Ht=P(()=>o("div",{class:"diy-edit-line"},null,-1)),zt={__name:"pageSet",props:{config:Object},setup(e){const r=e,l=async n=>{let a=n.target.files;for(var t=0;t<a.length;t++){let s=await yt(a[t]);r.config.templateImg=s}};return(n,a)=>{const t=C("el-input"),s=C("configItem"),i=C("selectColor"),m=C("el-image");return p(),b("div",null,[Gt,c(s,{label:"页面名称",style:{"margin-bottom":"20px"}},{default:E(()=>[c(t,{class:"flex-full",maxlength:12,modelValue:e.config.templateName,"onUpdate:modelValue":a[0]||(a[0]=d=>e.config.templateName=d),placeholder:"请输入页面名称"},null,8,["modelValue"]),Ut]),_:1}),c(s,{label:"页面标题"},{default:E(()=>[c(t,{class:"flex-full",modelValue:e.config.templateTitle,"onUpdate:modelValue":a[1]||(a[1]=d=>e.config.templateTitle=d),placeholder:"请输入页面标题"},null,8,["modelValue"])]),_:1}),c(s,{label:"页面背景"},{default:E(()=>[c(i,{modelValue:e.config.backgroundColor,"onUpdate:modelValue":a[2]||(a[2]=d=>e.config.backgroundColor=d),resetColor:"#ededed"},null,8,["modelValue"])]),_:1}),c(s,{label:"封面图",isRequire:!0},{default:E(()=>[o("div",{class:"upload-image",onClick:a[3]||(a[3]=d=>n.$refs.upload.click())},[K(c(m,{src:e.config.templateImg},null,8,["src"]),[[J,e.config.templateImg]]),K(o("span",null,"+",512),[[J,!e.config.templateImg]]),o("input",{type:"file",style:{display:"none"},onChange:l,ref:"upload",multiple:"true",accept:"image/jpg,image/jpeg,image/png,image/gif,image/bmp"},null,544)])]),_:1}),qt,Ht])}}},Ft=j(zt,[["__scopeId","data-v-64696a76"]]),M=e=>(H("data-v-cf49f297"),e=e(),z(),e),Kt={class:"diy-edit-box"},Jt={class:"header-info"},Wt={class:"title"},Xt=["src"],Qt=M(()=>o("span",{class:"iconfont icon-fuzhi1"},null,-1)),Yt=M(()=>o("span",null,"复制",-1)),Zt=[Qt,Yt],ea=M(()=>o("span",{class:"iconfont icon-shanchu2"},null,-1)),ta=M(()=>o("span",null,"删除",-1)),aa=[ea,ta],sa={class:"custom-scroll-bar edit-config-module"},oa={__name:"configPanel",props:{activeItem:Object},emits:["copy","delete"],setup(e,{emit:r}){let l=G.reduce((s,i)=>[...s,...i.data],[]);const n=r,a=X("baseInfo"),t=s=>{var m;let i=(m=l.filter(d=>d.component===s)[0])==null?void 0:m.icon;return new URL(Object.assign({"../../assets/images/default/audio.png":Z,"../../assets/images/default/banner.png":ee,"../../assets/images/default/bannerGoods.png":te,"../../assets/images/default/bargain.png":ae,"../../assets/images/default/blank.png":se,"../../assets/images/default/car1.png":oe,"../../assets/images/default/car2.png":ne,"../../assets/images/default/car3.png":ie,"../../assets/images/default/car4.png":le,"../../assets/images/default/channelvideo.png":ge,"../../assets/images/default/copyright.png":_e,"../../assets/images/default/countdown.png":me,"../../assets/images/default/coupon.png":ue,"../../assets/images/default/couponbag.png":de,"../../assets/images/default/course.png":re,"../../assets/images/default/creditshop.png":ce,"../../assets/images/default/creditsign.png":pe,"../../assets/images/default/cube.png":fe,"../../assets/images/default/default_banner.png":ve,"../../assets/images/default/default_btn1.png":be,"../../assets/images/default/default_btn2.png":he,"../../assets/images/default/default_btn3.png":Ee,"../../assets/images/default/default_btn4.png":ye,"../../assets/images/default/default_img.jpg":ke,"../../assets/images/default/default_picture.png":Ie,"../../assets/images/default/default_video.png":Ce,"../../assets/images/default/fixedsearch.png":Te,"../../assets/images/default/float.png":De,"../../assets/images/default/form.png":Oe,"../../assets/images/default/giftcard.png":we,"../../assets/images/default/goods,list.png":Ve,"../../assets/images/default/goods,one.png":Re,"../../assets/images/default/goods.png":je,"../../assets/images/default/goodsRanking.png":$e,"../../assets/images/default/groups.png":xe,"../../assets/images/default/groupscashback.png":Le,"../../assets/images/default/guess.png":Ae,"../../assets/images/default/guide.png":Pe,"../../assets/images/default/home-b.png":Me,"../../assets/images/default/hotel.png":Se,"../../assets/images/default/lecturer.png":Ne,"../../assets/images/default/line.png":Be,"../../assets/images/default/listmenu.png":Ge,"../../assets/images/default/live.png":Ue,"../../assets/images/default/member.png":qe,"../../assets/images/default/menu.png":He,"../../assets/images/default/note.png":ze,"../../assets/images/default/notice.png":Fe,"../../assets/images/default/otherGoods,three.png":Ke,"../../assets/images/default/otherGoods,three2.png":Je,"../../assets/images/default/otherGoods,three3.png":We,"../../assets/images/default/picture.png":Xe,"../../assets/images/default/pictures.png":Qe,"../../assets/images/default/presell.png":Ye,"../../assets/images/default/richtext.png":Ze,"../../assets/images/default/room.png":et,"../../assets/images/default/search.png":tt,"../../assets/images/default/seckill.png":at,"../../assets/images/default/tabbar.png":st,"../../assets/images/default/title.png":ot,"../../assets/images/default/title3.png":nt,"../../assets/images/default/twoGoods,list2.png":it,"../../assets/images/default/twoGoods,two.png":lt,"../../assets/images/default/video.png":gt,"../../assets/images/default/wxlive.png":_t})[`../../assets/images/default/${i||"course.png"}`],import.meta.url).href};return(s,i)=>(p(),b("div",Kt,[o("div",Jt,[o("p",Wt,[o("img",{src:t(e.activeItem.name),alt:""},null,8,Xt),L(" "+V(e.activeItem.title),1)]),T(a).category!=="BOTTOM_MENU"?(p(),b(x,{key:0},[o("p",{class:"pointer btn",onClick:i[0]||(i[0]=m=>n("copy"))},Zt),o("p",{class:"pointer btn",onClick:i[1]||(i[1]=m=>n("delete"))},aa)],64)):q("",!0)]),o("div",sa,[(p(),B(Y(e.activeItem.configComponent||Ft),{config:e.activeItem.config},null,8,["config"]))])]))}},na=j(oa,[["__scopeId","data-v-cf49f297"]]),{materialDatas:W}=mt();function ia(e,r,l){return{initData:async(t,s)=>{if(e.value.id=s,e.value.category=t,!s)if(["BOTTOM_MENU","HOME_ADVERT"].includes(t)){const u={BOTTOM_MENU:[{name:"tabbar"}],HOME_ADVERT:[{name:"advert"}]};r.value=u[t].map(f=>{let v=W[f.name];return v.config=Object.assign({},v.defConfig,f.config||{}),v}),l.value=0;return}else return;let{category:i,sourceType:m,templateTitle:d,templateName:y,templateImg:h,backgroundColor:k,searchKey:D,templateConfigParams:O,componentIds:S}=await kt(s),g=JSON.parse(O).map(u=>{let f=R(u.config),v=W[u.name],w=R(v.defConfig);return It(w,f),v.config=w,v});console.log("testData",g),r.value=g,e.value.category=i,e.value.sourceType=m,e.value.templateName=y,e.value.templateTitle=d,e.value.templateImg=h,e.value.backgroundColor=k,e.value.searchKey=D,e.value.componentIds=S,["BOTTOM_MENU","HOME_ADVERT"].includes(i)&&(l.value=0)},submitData:async(t=!1)=>{let s=r.value.map(({name:k,title:D,config:O})=>({name:k,title:D,config:O})),i={...e.value},{id:m,templateName:d,templateImg:y}=i;if(!d)return A({type:"warning",message:"模板名称不能为空 "});if(!y)return A({type:"warning",message:"模板封面不能为空 "});i.templateConfigParams=JSON.stringify(s),console.log("params",s);let h=await Ct(i);if(m&&t)return Bus.emit("preview",{templateName:d,id:m});console.log("返回 result:",h,t),A({type:"success",message:"保存成功"})}}}const la=e=>(H("data-v-8242c358"),e=e(),z(),e),ga={class:"wrapper"},_a={class:"wrapper-header"},ma=la(()=>o("div",{class:"flex-1"},null,-1)),ua={__name:"index",setup(e){const r=ft(),l=vt(),n=$({id:"",category:"HOME",sourceType:"MARKET_APPLETS",templateName:"",templateTitle:"",templateImg:"",backgroundColor:"#ffffff",searchKey:"v",templateConfigParams:"[]",componentIds:""});rt("baseInfo",n.value);const a=$([]),t=$(-1),s=ct(()=>a.value[t.value]||{title:"全局设置",isGlobal:!0,config:n.value}),{initData:i,submitData:m}=ia(n,a,t),d=(g,u=!1)=>{if(u&&a.value.some(v=>v.name===g.name))return A({message:`${g.title}组件只能添加一个`,type:"warning"});let f=R(g);f.config=R(f.defConfig),t.value===-1?(a.value.push(f),t.value=a.value.length-1):(a.value.splice(t.value+1,0,f),t.value=t.value+1)},y=g=>t.value>=0,h=g=>{t.value=g.newIndex},k=g=>{t.value=g},D=()=>{let g=t.value;if(g===-1)return;let u=R(a.value[g]);a.value.splice(g+1,0,u),t.value+=1},O=async()=>{let g=t.value;if(g===-1)return;await bt.confirm("确定删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})==="confirm"&&(a.value.splice(g,1),g>=a.value.length-1&&(t.value=a.value.length-1))},S=()=>l.back();return Q(()=>{let{type:g,id:u=""}=r.query;const f=pt.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"});setTimeout(()=>{i(g,u),f.close()},1e3)}),(g,u)=>{const f=C("ArrowLeft"),v=C("el-icon"),w=C("el-button");return p(),b("div",ga,[o("div",_a,[o("div",{class:"left-back",onClick:S},[c(v,null,{default:E(()=>[c(f)]),_:1}),L("返回 ")]),ma,n.value.id?(p(),B(w,{key:0,type:"primary",onClick:u[0]||(u[0]=I=>T(m)(!0))},{default:E(()=>[L("保存并预览")]),_:1})):q("",!0),c(w,{type:"primary",onClick:u[1]||(u[1]=I=>T(m)(!1))},{default:E(()=>[L("保存")]),_:1})]),c(At,{activeIndex:t.value,onAdd:d},null,8,["activeIndex"]),c(Bt,{pageConfig:n.value,onSelect:u[3]||(u[3]=I=>k(-1))},{default:E(()=>[c(T(ht),{style:U({height:n.value.category==="advert"?"100%":"unset"}),modelValue:a.value,"onUpdate:modelValue":u[2]||(u[2]=I=>a.value=I),move:y,onUpdate:h,"item-key":"index"},{item:E(({element:I,index:N})=>[o("div",null,[(p(),B(Y(I.componentName),{"item-key":N,class:Et({editing:!0,selected:N===t.value}),config:I.config,onClick:da=>k(N)},null,8,["item-key","class","config","onClick"]))])]),_:1},8,["style","modelValue"])]),_:1},8,["pageConfig"]),c(na,{activeItem:s.value,onCopy:D,onDelete:O},null,8,["activeItem"])])}}},pa=j(ua,[["__scopeId","data-v-8242c358"]]);export{pa as default};
