import{O as gt,r as x,P as H,o as K,e as r,f as v,F as S,g as B,k as o,t as I,Q as M,l as V,R as _t,d as h,h as d,w as b,y as N,A as G,s as q,v as F,q as A,i as J,j as z,b as Q,E as mt,S as ut,T as dt,u as ct,B as rt,U as pt,n as ft}from"./index-BdoJKyZb.js";import{_ as W,a as X,b as Y,c as Z,d as ee,e as te,f as se,g as ae,h as oe,i as le,j as ie,k as ne,l as ge,m as _e,n as me,o as ue,p as de,q as ce,r as re,s as pe,t as fe,u as ve,v as be,w as he,x as Ee,y as ke,z as ye,A as Ie,B as Ce,C as Te,D as De,E as Oe,F as we,G as xe,H as Ve,I as Re,J as je,K as Pe,L as Le,M as $e,N as Ae,O as Me,P as Se,Q as Be,R as Ne,S as Ge,T as Ue,U as He,V as Ke,W as qe,X as Fe,Y as Je,Z as ze,$ as Qe,a0 as We,a1 as Xe}from"./wxlive-qEk8kMXx.js";import{a as _,_ as T,b as Ye,c as Ze,d as et,e as tt,f as st,g as at,h as ot,i as lt,j as C,k as vt}from"./index-wwZ3BqaF.js";import{a as bt,b as ht}from"./diyPage-BnXfnTme.js";const it=gt("common",()=>{const e=x({}),m=Object.assign({"../material/assistBlank/config.js":()=>_(()=>import("./config-6mH-mRtp.js"),[],import.meta.url),"../material/assistLine/config.js":()=>_(()=>import("./config-DVat-B7F.js"),[],import.meta.url),"../material/buttons/config.js":()=>_(()=>import("./config-DrHlRjc_.js"),[],import.meta.url),"../material/floatButtons/config.js":()=>_(()=>import("./config-MJyAnOlG.js"),[],import.meta.url),"../material/goods/config.js":()=>_(()=>import("./config-D-F9nYU0.js"),[],import.meta.url),"../material/goodsLikes/config.js":()=>_(()=>import("./config-Cv8U3N24.js"),[],import.meta.url),"../material/goodsRanking/config.js":()=>_(()=>import("./config-C96ImJ01.js"),[],import.meta.url),"../material/goodsScore/config.js":()=>_(()=>import("./config-DFp4eqEb.js"),[],import.meta.url),"../material/goodsTabbar/config.js":()=>_(()=>import("./config-DVru772T.js"),[],import.meta.url),"../material/listMenu/config.js":()=>_(()=>import("./config-BxseHsg4.js"),[],import.meta.url),"../material/pictureShow/config.js":()=>_(()=>import("./config-DS27NU-V.js"),[],import.meta.url),"../material/search/config.js":()=>_(()=>import("./config-B-VjoYRn.js"),[],import.meta.url),"../material/singleChart/config.js":()=>_(()=>import("./config-CetF3cK4.js"),[],import.meta.url),"../material/swiper/config.js":()=>_(()=>import("./config-Bp-Thqmt.js"),[],import.meta.url),"../material/tabbar/config.js":()=>_(()=>import("./config-Bjxhfm_1.js"),[],import.meta.url),"../material/title/config.js":()=>_(()=>import("./config-CiNPRnwn.js"),[],import.meta.url),"../material/video/config.js":()=>_(()=>import("./config-DPJ3dUps.js"),[],import.meta.url)});return Object.keys(m).forEach(async a=>{let l=a.replace(/\/config.js/,"").replace(/.*\//,"");e.value[l]={name:l,componentName:"diy-"+l,configComponent:"conf-"+l,getDefaultConfig:m[a]}}),{materialDatas:e}}),nt=[{name:"商品类",data:[{name:"商品组",icon:"goods.png",component:"goods"},{name:"选项卡",icon:"tabbar.png",component:"goodsTabbar"},{name:"猜你喜欢",icon:"guess.png",component:"goodsLikes"},{name:"商品排行",icon:"goodsRanking.png",component:"goodsRanking"},{name:"积分商城",icon:"creditshop.png",component:"goodsScore"}]},{name:"图文类 ",data:[{name:"搜索框",icon:"search.png",component:"search"},{name:"图片轮播",icon:"banner.png",component:"swiper"},{name:"图片(热区)",icon:"picture.png",component:"singleChart"},{name:"图片展播",icon:"pictures.png",component:"pictureShow"},{name:"列表导航",icon:"listmenu.png",component:"listMenu"},{name:"辅助线",icon:"line.png",component:"assistLine"},{name:"标题栏",icon:"title.png",component:"title"},{name:"辅助空白",icon:"blank.png",component:"assistBlank"},{name:"按钮组",icon:"menu.png",component:"buttons"},{name:"视频播放",icon:"video.png",component:"video"},{name:"浮动按钮",icon:"float.png",component:"floatButtons"}]}],Et={class:"module-select-box"},kt={class:"module-list_type"},yt={class:"module-list_data"},It=["onClick"],Ct={class:"title"},Tt={__name:"materialPanel",emits:["add","global"],setup(e,{emit:m}){const{materialDatas:a}=it(),l=m;H("baseInfo");const s=t=>({backgroundImage:`url(${new URL(Object.assign({"../../assets/images/default/audio.png":W,"../../assets/images/default/banner.png":X,"../../assets/images/default/bannerGoods.png":Y,"../../assets/images/default/bargain.png":Z,"../../assets/images/default/blank.png":ee,"../../assets/images/default/car1.png":te,"../../assets/images/default/car2.png":se,"../../assets/images/default/car3.png":ae,"../../assets/images/default/car4.png":oe,"../../assets/images/default/channelvideo.png":le,"../../assets/images/default/copyright.png":ie,"../../assets/images/default/countdown.png":ne,"../../assets/images/default/coupon.png":ge,"../../assets/images/default/couponbag.png":_e,"../../assets/images/default/course.png":me,"../../assets/images/default/creditshop.png":ue,"../../assets/images/default/creditsign.png":de,"../../assets/images/default/cube.png":ce,"../../assets/images/default/default_banner.png":Ye,"../../assets/images/default/default_btn1.png":Ze,"../../assets/images/default/default_btn2.png":et,"../../assets/images/default/default_btn3.png":tt,"../../assets/images/default/default_btn4.png":st,"../../assets/images/default/default_img.jpg":at,"../../assets/images/default/default_picture.png":ot,"../../assets/images/default/default_video.png":lt,"../../assets/images/default/fixedsearch.png":re,"../../assets/images/default/float.png":pe,"../../assets/images/default/form.png":fe,"../../assets/images/default/giftcard.png":ve,"../../assets/images/default/goods,list.png":be,"../../assets/images/default/goods,one.png":he,"../../assets/images/default/goods.png":Ee,"../../assets/images/default/goodsRanking.png":ke,"../../assets/images/default/groups.png":ye,"../../assets/images/default/groupscashback.png":Ie,"../../assets/images/default/guess.png":Ce,"../../assets/images/default/guide.png":Te,"../../assets/images/default/home-b.png":De,"../../assets/images/default/hotel.png":Oe,"../../assets/images/default/lecturer.png":we,"../../assets/images/default/line.png":xe,"../../assets/images/default/listmenu.png":Ve,"../../assets/images/default/live.png":Re,"../../assets/images/default/menu.png":je,"../../assets/images/default/note.png":Pe,"../../assets/images/default/notice.png":Le,"../../assets/images/default/otherGoods,three.png":$e,"../../assets/images/default/otherGoods,three2.png":Ae,"../../assets/images/default/otherGoods,three3.png":Me,"../../assets/images/default/picture.png":Se,"../../assets/images/default/pictures.png":Be,"../../assets/images/default/presell.png":Ne,"../../assets/images/default/richtext.png":Ge,"../../assets/images/default/room.png":Ue,"../../assets/images/default/search.png":He,"../../assets/images/default/seckill.png":Ke,"../../assets/images/default/tabbar.png":qe,"../../assets/images/default/title.png":Fe,"../../assets/images/default/title3.png":Je,"../../assets/images/default/twoGoods,list2.png":ze,"../../assets/images/default/twoGoods,two.png":Qe,"../../assets/images/default/video.png":We,"../../assets/images/default/wxlive.png":Xe})[`../../assets/images/default/${t}`],import.meta.url).href})`});return K(async()=>{if(Object.keys(a).some(t=>!a[t].title))for(const t in a){let i=(await a[t].getDefaultConfig()).default;a[t].title=i.title,a[t].defConfig=i,delete a[t].getDefaultConfig}}),(t,i)=>(r(),v("div",Et,[(r(!0),v(S,null,B(V(nt),(c,p)=>(r(),v("div",{class:"module-list",key:p},[o("div",kt,I(c.name)+"("+I(c.data.length)+")",1),o("div",yt,[(r(!0),v(S,null,B(c.data,(u,k)=>(r(),v("div",{class:"module-list_data_item",style:M(s(u.icon)),key:"c_"+k,onClick:D=>l("add",V(a)[u.component])},[o("p",Ct,I(u.name),1)],12,It))),128))])]))),128))]))}},Dt=T(Tt,[["__scopeId","data-v-f58a68e4"]]),Ot={class:"phone-wrapper"},wt={class:"diy-phone"},xt={class:"phone_title"},Vt={__name:"renderEngine",props:{pageConfig:Object},emits:["select"],setup(e,{emit:m}){const a=m;return(l,s)=>(r(),v("div",Ot,[o("div",wt,[o("div",{class:"text-overflow phone-header",onClick:s[0]||(s[0]=t=>a("select"))},[o("div",xt,I(e.pageConfig.templateTitle),1)]),o("div",{class:"custom-scroll-bar phone-body",style:M({"background-color":e.pageConfig.backgroundColor})},[_t(l.$slots,"default",{},void 0,!0)],4)])]))}},Rt=T(Vt,[["__scopeId","data-v-06ef4988"]]),R=e=>(q("data-v-02575c21"),e=e(),F(),e),jt=R(()=>o("div",{class:"module-edit-title"},"页面设置",-1)),Pt=R(()=>o("p",{class:"tips-info"},"注意：页面名称是便于后台查找。",-1)),Lt=R(()=>o("div",{class:"tips-info",style:{margin:"-10px 0 10px 78px"}},"建议尺寸256 * 414 (大小建议不超过800k，以免影响加载速度)",-1)),$t=R(()=>o("div",{class:"diy-edit-line"},null,-1)),At={__name:"pageSet",props:{config:Object},setup(e){const m=e,a=()=>Bus.emit("selectImage",l=>m.config.images=l.url);return(l,s)=>{const t=h("el-input"),i=h("configItem"),c=h("selectColor"),p=h("el-image");return r(),v("div",null,[jt,d(i,{label:"页面名称",style:{"margin-bottom":"20px"}},{default:b(()=>[d(t,{class:"flex-full",maxlength:12,modelValue:e.config.templateName,"onUpdate:modelValue":s[0]||(s[0]=u=>e.config.templateName=u),placeholder:"请输入页面名称"},null,8,["modelValue"]),Pt]),_:1}),d(i,{label:"页面标题"},{default:b(()=>[d(t,{class:"flex-full",modelValue:e.config.templateTitle,"onUpdate:modelValue":s[1]||(s[1]=u=>e.config.templateTitle=u),placeholder:"请输入页面标题"},null,8,["modelValue"])]),_:1}),d(i,{label:"页面背景"},{default:b(()=>[d(c,{modelValue:e.config.backgroundColor,"onUpdate:modelValue":s[2]||(s[2]=u=>e.config.backgroundColor=u),resetColor:"#ededed"},null,8,["modelValue"])]),_:1}),d(i,{label:"封面图",isRequire:!0},{default:b(()=>[o("div",{class:"upload-image",onClick:a},[N(d(p,{src:e.config.templateImg},null,8,["src"]),[[G,e.config.templateImg]]),N(o("span",null,"+",512),[[G,!e.config.templateImg]])])]),_:1}),Lt,$t])}}},Mt=T(At,[["__scopeId","data-v-02575c21"]]),St={class:"diy-edit-box"},Bt={class:"header-info"},Nt={class:"title"},Gt=["src"],Ut={class:"custom-scroll-bar edit-config-module"},Ht={__name:"configPanel",props:{activeItem:Object},emits:["copy","delete"],setup(e,{emit:m}){let a=nt.reduce((s,t)=>[...s,...t.data],[]);H("baseInfo");const l=s=>{var i;let t=(i=a.filter(c=>c.component===s)[0])==null?void 0:i.icon;return new URL(Object.assign({"../../assets/images/default/audio.png":W,"../../assets/images/default/banner.png":X,"../../assets/images/default/bannerGoods.png":Y,"../../assets/images/default/bargain.png":Z,"../../assets/images/default/blank.png":ee,"../../assets/images/default/car1.png":te,"../../assets/images/default/car2.png":se,"../../assets/images/default/car3.png":ae,"../../assets/images/default/car4.png":oe,"../../assets/images/default/channelvideo.png":le,"../../assets/images/default/copyright.png":ie,"../../assets/images/default/countdown.png":ne,"../../assets/images/default/coupon.png":ge,"../../assets/images/default/couponbag.png":_e,"../../assets/images/default/course.png":me,"../../assets/images/default/creditshop.png":ue,"../../assets/images/default/creditsign.png":de,"../../assets/images/default/cube.png":ce,"../../assets/images/default/default_banner.png":Ye,"../../assets/images/default/default_btn1.png":Ze,"../../assets/images/default/default_btn2.png":et,"../../assets/images/default/default_btn3.png":tt,"../../assets/images/default/default_btn4.png":st,"../../assets/images/default/default_img.jpg":at,"../../assets/images/default/default_picture.png":ot,"../../assets/images/default/default_video.png":lt,"../../assets/images/default/fixedsearch.png":re,"../../assets/images/default/float.png":pe,"../../assets/images/default/form.png":fe,"../../assets/images/default/giftcard.png":ve,"../../assets/images/default/goods,list.png":be,"../../assets/images/default/goods,one.png":he,"../../assets/images/default/goods.png":Ee,"../../assets/images/default/goodsRanking.png":ke,"../../assets/images/default/groups.png":ye,"../../assets/images/default/groupscashback.png":Ie,"../../assets/images/default/guess.png":Ce,"../../assets/images/default/guide.png":Te,"../../assets/images/default/home-b.png":De,"../../assets/images/default/hotel.png":Oe,"../../assets/images/default/lecturer.png":we,"../../assets/images/default/line.png":xe,"../../assets/images/default/listmenu.png":Ve,"../../assets/images/default/live.png":Re,"../../assets/images/default/menu.png":je,"../../assets/images/default/note.png":Pe,"../../assets/images/default/notice.png":Le,"../../assets/images/default/otherGoods,three.png":$e,"../../assets/images/default/otherGoods,three2.png":Ae,"../../assets/images/default/otherGoods,three3.png":Me,"../../assets/images/default/picture.png":Se,"../../assets/images/default/pictures.png":Be,"../../assets/images/default/presell.png":Ne,"../../assets/images/default/richtext.png":Ge,"../../assets/images/default/room.png":Ue,"../../assets/images/default/search.png":He,"../../assets/images/default/seckill.png":Ke,"../../assets/images/default/tabbar.png":qe,"../../assets/images/default/title.png":Fe,"../../assets/images/default/title3.png":Je,"../../assets/images/default/twoGoods,list2.png":ze,"../../assets/images/default/twoGoods,two.png":Qe,"../../assets/images/default/video.png":We,"../../assets/images/default/wxlive.png":Xe})[`../../assets/images/default/${t||"course.png"}`],import.meta.url).href};return(s,t)=>(r(),v("div",St,[o("div",Bt,[o("p",Nt,[o("img",{src:l(e.activeItem.name),alt:""},null,8,Gt),A(" "+I(e.activeItem.title),1)])]),o("div",Ut,[(r(),J(z(e.activeItem.configComponent||Mt),{config:e.activeItem.config},null,8,["config"]))])]))}},Kt=T(Ht,[["__scopeId","data-v-61129b33"]]),{materialDatas:U}=it();function qt(e,m,a){return Q(),{initData:async(t,i)=>{if(e.value.id=i,e.value.category=t,!i)if(["BOTTOM_MENU","HOME_ADVERT"].includes(t)){const g={BOTTOM_MENU:[{name:"tabbar"}],HOME_ADVERT:[{name:"advert"}]};m.value=g[t].map(E=>{let f=U[E.name];return f.config=Object.assign({},f.defConfig,E.config||{}),f}),a.value=0;return}else return;let{category:c,sourceType:p,templateTitle:u,templateName:k,templateImg:D,backgroundColor:O,searchKey:j,templateConfigParams:P,componentIds:L}=await bt(i),n=JSON.parse(P).map(g=>{let E=C(g.config),f=U[g.name],w=C(f.defConfig);return vt(w,E),f.config=w,f});console.log("testData",n),m.value=n,e.value.category=c,e.value.sourceType=p,e.value.templateName=k,e.value.templateTitle=u,e.value.templateImg=D,e.value.backgroundColor=O,e.value.searchKey=j,e.value.componentIds=L,["BOTTOM_MENU","HOME_ADVERT"].includes(c)&&(a.value=0)},submitData:async()=>{let t=m.value.map(({name:c,title:p,config:u})=>({name:c,title:p,config:u})),i={...e.value};i.templateConfigParams=JSON.stringify(t),await ht(i),mt({type:"success",message:"保存成功"})}}}const Ft=e=>(q("data-v-087a94b8"),e=e(),F(),e),Jt={class:"wrapper"},zt={class:"wrapper-header"},Qt=Ft(()=>o("div",{class:"flex-1"},null,-1)),Wt={__name:"index",setup(e){const m=ct(),a=Q(),l=x({id:"",category:"HOME",sourceType:"MARKET_APPLETS",templateName:"页面名称",templateTitle:"页面标题",templateImg:"https://img0.baidu.com/it/u=3773090653,2338589126&fm=253&fmt=auto&app=138&f=JPEG?w=750&h=500",backgroundColor:"#ffffff",searchKey:"首页",templateConfigParams:"[]",componentIds:""});ut("baseInfo",l.value);const s=x([]),t=x(-1),i=dt(()=>s.value[t.value]||{title:"全局设置",isGlobal:!0,config:l.value}),{initData:c,submitData:p}=qt(l,s,t),u=n=>{let g=C(n);g.config=C(g.defConfig),t.value===-1?(s.value.push(g),t.value=s.value.length-1):(s.value.splice(t.value+1,0,g),t.value=t.value+1)},k=n=>t.value>=0,D=n=>{t.value=n.newIndex},O=n=>{t.value=n},j=()=>{let n=t.value;if(n===-1)return;let g=C(s.value[n]);s.value.splice(n+1,0,g),t.value+=1},P=async()=>{let n=t.value;if(n===-1)return;await rt.confirm("确定删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})==="confirm"&&(s.value.splice(n,1),n>=s.value.length-1&&(t.value=s.value.length-1))},L=()=>a.back();return K(()=>{let{type:n,id:g=""}=m.query;setTimeout(()=>{c(n,g)},500)}),(n,g)=>{const E=h("ArrowLeft"),f=h("el-icon"),w=h("el-button");return r(),v("div",Jt,[o("div",zt,[o("div",{class:"left-back",onClick:L},[d(f,null,{default:b(()=>[d(E)]),_:1}),A("返回 ")]),Qt,d(w,{type:"primary",onClick:V(p)},{default:b(()=>[A("保存")]),_:1},8,["onClick"])]),d(Dt,{activeIndex:t.value,onAdd:u},null,8,["activeIndex"]),d(Rt,{pageConfig:l.value,onSelect:g[1]||(g[1]=y=>O(-1))},{default:b(()=>[d(V(pt),{style:M({height:l.value.category==="advert"?"100%":"unset"}),modelValue:s.value,"onUpdate:modelValue":g[0]||(g[0]=y=>s.value=y),move:k,onUpdate:D,"item-key":"index"},{item:b(({element:y,index:$})=>[o("div",null,[(r(),J(z(y.componentName),{"item-key":$,class:ft({editing:!0,selected:$===t.value}),config:y.config,onClick:Xt=>O($)},null,8,["item-key","class","config","onClick"]))])]),_:1},8,["style","modelValue"])]),_:1},8,["pageConfig"]),d(Kt,{activeItem:i.value,onCopy:j,onDelete:P},null,8,["activeItem"])])}}},ss=T(Wt,[["__scopeId","data-v-087a94b8"]]);export{ss as default};
